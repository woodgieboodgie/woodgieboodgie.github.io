jQuery(function(h){var e,i,s,l=(i=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",s=8==(e=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1])||9==e&&"file:"!=location.protocol?function(e,t){var a=new XDomainRequest,r=h.Deferred();return a.open(t.type,e),a.onload=function(){r.resolve(this.responseText)},a.onerror=function(){r.reject()},a.send(t.data),r}:(h.support.cors=!0,h.ajax),a.prototype.email=function(e){return t.call(this,"email",arguments)},a.prototype.title=function(e){return t.call(this,"title",arguments)},a.prototype.data=function(e){return t.call(this,"data",arguments)},a.prototype.send=function(e,t){var a,r,n,o=(a=h.Deferred(),r=this,n=["email","title","data","send"],h.each(n,function(e,t){a[t]=function(){return r[t].apply(r,arguments)}}),a);return t&&(t.call(this,o),"pending"!=o.state())||s(i,{type:"POST",data:JSON.stringify({email:this.__email__,form:{title:this.__title__,data:arguments.length?e:this.__data__}})}).done(function(e){try{var t=JSON.parse(e);t.error?o.reject(t.error):o.resolve(t.response)}catch(e){o.reject("Incorrect server response.")}}).fail(function(){var e="Failed to query the server. ";"onLine"in navigator&&!navigator.onLine?e+="No connection to the Internet.":e+="Check the connection and try again.",o.reject(e)}),o},{Form:function(e){return new a(e)}});function t(e,t){return e="__"+e+"__",t.length?(this[e]=t[0],this):this[e]}function a(e){e=e||{},this.__email__=e.email||"",this.__title__=e.title||"",this.__data__=e.data||[]}h('[data-form-type="formoid"]').each(function(){var a,r=h(this),n=r.is("form")?r:r.find("form"),u=r.find("[data-form-alert]"),o=r.is("[data-form-title]")?r:r.find("[data-form-title]"),m=r.find('[type="submit"]'),i=n.find("[data-form-field]"),s=u.html();n.change(function(e){"file"===e.target.type&&1e6<e.target.files[0].size&&(u.removeAttr("hidden"),u.removeClass("alert-success").addClass("alert-danger"),u.html("File size must be less than 1mb"),m.addClass("btn-loading").prop("disabled",!0))}),i.each(function(e,t){h(t).on("focus",function(){u.attr("hidden","hidden"),u.addClass("alert-success").removeClass("alert-danger"),u.html(""),m.removeClass("btn-loading").prop("disabled",!1)})}),n.submit(function(e){var d,t,c,f;e.preventDefault(),m.hasClass("btn-loading")||(d=[],e=i,n.addClass("form-active"),m.addClass("btn-loading").prop("disabled",!0),u.html(""),a=a||l.Form({email:r.find("[data-form-email]").val(),title:o.attr("data-form-title")||o.text()}),t=e,c=h.Deferred(),f=[],t.each(function(e,t){var a,r=h(t),n=r.attr("type"),o=h.Deferred();if(f.push(o),"email"===r.attr("name")&&(a=!0,(t=h(t=t).val())&&(a=/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(t)),!a))return m.removeClass("btn-loading").prop("disabled",!0),c.reject(new Error("Form is not valid")),!1;switch(n){case"file":var i=new FileReader,s=r.attr("data-form-field")||r.attr("name"),l=r[0].files[0];i.onloadend=function(){d.push([s,i.result]),o.resolve()},i.onerror=function(){u.html(i.error),c.reject(i.error)},l&&i.readAsDataURL(l);break;case"checkbox":d.push([r.attr("data-form-field")||r.attr("name"),r.prop("checked")?r.val():"No"]),o.resolve();break;case"radio":r.prop("checked")&&d.push([r.attr("data-form-field")||r.attr("name"),r.val()]),o.resolve();break;default:d.push([r.attr("data-form-field")||r.attr("name"),r.val()]),o.resolve()}}),c.resolve(f).then(function(e){h.when.apply(this,e).then(function(){a.send(d).always(function(){m.removeClass("btn-loading").prop("disabled",!1),u.removeAttr("hidden")}).then(function(e){n[0].reset(),n.removeClass("form-active"),u.text(s||e),u.removeClass("alert-danger").addClass("alert-success")}).fail(function(e){u.text(e),u.removeClass("alert-success").addClass("alert-danger")})},function(e){u.html(e.message),u.removeClass("alert-success").addClass("alert-danger"),u.removeAttr("hidden")})}))})})});